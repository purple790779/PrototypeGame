<!doctype html>
<html lang="ko">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <base href="./" />
    <title>프로젝트 오메가 - 에테르의 눈물</title>
    <link rel="stylesheet" href="style.css?v=0.3.2" />
  </head>
  <body>
    <div id="introOverlay" class="intro-overlay" role="dialog" aria-modal="true" aria-label="인트로" tabindex="0">
      <svg class="intro__bg" viewBox="0 0 1200 800" preserveAspectRatio="xMidYMid slice" aria-hidden="true">
        <defs>
          <linearGradient id="intro-sky" x1="0" y1="0" x2="0" y2="1">
            <stop offset="0%" stop-color="#0e1a2b" />
            <stop offset="55%" stop-color="#1c2b3c" />
            <stop offset="100%" stop-color="#1f2a26" />
          </linearGradient>
          <linearGradient id="intro-glow" x1="0" y1="0" x2="1" y2="1">
            <stop offset="0%" stop-color="#2a4c6d" stop-opacity="0.8" />
            <stop offset="100%" stop-color="#14202f" stop-opacity="0" />
          </linearGradient>
          <linearGradient id="intro-hill" x1="0" y1="0" x2="0" y2="1">
            <stop offset="0%" stop-color="#1b2e1f" />
            <stop offset="100%" stop-color="#0f1913" />
          </linearGradient>
          <linearGradient id="intro-forest" x1="0" y1="0" x2="0" y2="1">
            <stop offset="0%" stop-color="#17231a" />
            <stop offset="100%" stop-color="#0a120d" />
          </linearGradient>
        </defs>
        <rect width="1200" height="800" fill="url(#intro-sky)" />
        <circle cx="840" cy="180" r="220" fill="url(#intro-glow)" />
        <path
          d="M0 520 C 160 470 320 520 480 500 C 640 480 800 540 960 510 C 1080 490 1160 520 1200 500 L1200 800 L0 800 Z"
          fill="url(#intro-hill)"
        />
        <path
          d="M0 600 C 220 560 360 620 540 590 C 720 560 900 630 1080 600 L1200 650 L1200 800 L0 800 Z"
          fill="#111a12"
        />
        <path
          d="M0 640 C 140 620 220 660 320 650 C 420 640 520 670 640 660 C 760 650 840 680 960 670 C 1080 660 1140 690 1200 680 L1200 800 L0 800 Z"
          fill="url(#intro-forest)"
        />
      </svg>
      <div class="intro__content">
        <h1 class="intro__title">루카스 어드벤처</h1>
        <p class="intro__subtitle">빛바랜 들판 위, 새로운 이야기가 시작됩니다.</p>
      </div>
      <div class="intro__footer">
        <p class="intro__hint">시작하려면 화면을 터치하세요</p>
      </div>
    </div>
    <div class="app">
      <header class="top-hud" aria-label="탐험 HUD">
        <div class="top-hud__left" id="hud-profile">
          <div class="avatar" aria-hidden="true">Ω</div>
          <div class="profile-meta">
            <div class="profile-row">
              <strong class="profile-name" id="player-name">모험가</strong>
              <span class="version" id="version-label">v0.3.2</span>
              <button id="btn-reset" class="btn btn--ghost btn--tiny">새 여정</button>
            </div>
            <div class="profile-stats">
              <div class="hud-pill" id="hud-hp" aria-label="체력">
                <span class="hud-pill__icon" aria-hidden="true">❤️</span>
                <span class="hud-pill__value">0/0</span>
              </div>
              <div class="hud-pill" id="hud-mp" aria-label="마나">
                <span class="hud-pill__icon" aria-hidden="true">💠</span>
                <span class="hud-pill__value">0/0</span>
              </div>
              <div class="hud-pill" id="hud-gold" aria-label="골드">
                <span class="hud-pill__icon" aria-hidden="true">🪙</span>
                <span class="hud-pill__value">0</span>
              </div>
            </div>
          </div>
        </div>
        <div class="top-hud__right" id="hud-stats">
          <div class="stat-chip" aria-label="힘" data-tooltip="STR" data-toast="STR">
            <span class="stat-chip__icon" aria-hidden="true">⚔️</span>
            <span class="stat-chip__value" id="hud-stat-str">0</span>
          </div>
          <div class="stat-chip" aria-label="지혜" data-tooltip="WIS" data-toast="WIS">
            <span class="stat-chip__icon" aria-hidden="true">🧠</span>
            <span class="stat-chip__value" id="hud-stat-wis">0</span>
          </div>
          <div class="stat-chip" aria-label="지능" data-tooltip="INT" data-toast="INT">
            <span class="stat-chip__icon" aria-hidden="true">📘</span>
            <span class="stat-chip__value" id="hud-stat-int">0</span>
          </div>
          <div class="stat-chip" aria-label="민첩" data-tooltip="DEX" data-toast="DEX">
            <span class="stat-chip__icon" aria-hidden="true">🏹</span>
            <span class="stat-chip__value" id="hud-stat-dex">0</span>
          </div>
          <div class="stat-chip" aria-label="행운" data-tooltip="LUK" data-toast="LUK">
            <span class="stat-chip__icon" aria-hidden="true">🍀</span>
            <span class="stat-chip__value" id="hud-stat-luk">0</span>
          </div>
          <button
            id="btn-save"
            class="icon-btn"
            aria-label="저장"
            data-tooltip="저장"
            data-toast="저장"
            type="button"
          >
            💾
          </button>
          <button
            id="btn-audio"
            class="icon-btn icon-btn--audio"
            aria-label="배경음악 켜기/끄기"
            aria-pressed="false"
            data-tooltip="BGM"
            data-toast="BGM"
            type="button"
          >
            🔈
          </button>
        </div>
      </header>

      <main class="main-center" id="main-center">
        <section class="event-card" id="explore-card" aria-live="polite">
          <div class="event-card__dice">
            <div class="dice dice--small" id="dice-value">--</div>
            <div class="dice__label" id="dice-label">주사위 대기</div>
          </div>
          <div class="event-card__content">
            <h2 id="scene-title">준비 중...</h2>
            <p id="scene-text">데이터를 불러오는 중입니다.</p>
            <div class="event-card__resume" id="resume-combat" hidden>
              <p>전투 진행 중인 기록이 있습니다.</p>
              <button class="btn btn--ghost btn--small" id="btn-resume-combat">전투 재개</button>
            </div>
            <div class="data-error" id="data-error" hidden>
              <p class="data-error__title">데이터 로드 실패</p>
              <pre class="data-error__list" id="data-error-list"></pre>
              <div class="data-error__actions">
                <button class="btn btn--ghost btn--small" id="btn-retry-load">다시 시도</button>
                <button class="btn btn--ghost btn--small" id="btn-hard-reset">긴급 초기화</button>
              </div>
            </div>
            <div class="event-card__choices" id="choice-list"></div>
          </div>
        </section>

        <section class="combat-scene" id="combat-scene" hidden aria-live="polite">
          <div class="combat-scene__frame">
        <header class="combat-scene__header">
          <div class="combat-card">
            <div class="combat-card__label">모험가</div>
            <div class="combat-card__name" id="combat-player-name">당신</div>
            <div class="combat-card__bar" aria-label="플레이어 체력">
              <span id="combat-player-hp"></span>
            </div>
            <div class="combat-card__status" id="combat-player-status"></div>
          </div>
          <div class="combat-card">
            <div class="combat-card__label">적</div>
            <div class="combat-card__name" id="combat-enemy-name">-</div>
            <div class="combat-card__bar" aria-label="적 체력">
              <span id="combat-enemy-hp"></span>
            </div>
            <div class="combat-card__status" id="combat-enemy-status"></div>
          </div>
        </header>

        <div class="combat-scene__meter" id="combat-meter">
          <span>우세도</span>
          <div class="meter">
            <span id="combat-advantage"></span>
          </div>
          <strong id="combat-advantage-label">-</strong>
        </div>

        <div class="combat-scene__center">
          <div class="combat-scene__panel" id="combat-situation">전투가 시작됐다.</div>
          <div class="combat-scene__recover" id="combat-recover" hidden>
            <p>전투 데이터를 복원할 수 없습니다.</p>
            <button class="btn btn--ghost" id="btn-combat-recover">탐험으로 복귀</button>
          </div>
          <div class="combat-scene__dice" id="combat-dice-panel">
            <div class="dice dice--large" id="combat-dice-value">--</div>
            <div class="dice__label" id="combat-dice-label">전투 판정</div>
            <span class="combat-scene__badge" id="combat-dice-badge">-</span>
          </div>
        </div>

        <div class="combat-scene__log" id="combat-log"></div>

        <nav class="combat-dock" aria-label="전투 커맨드" id="combat-dock"></nav>
      </div>
        </section>
      </main>

      <section class="log-panel is-collapsed" id="log-panel" aria-label="텍스트 로그">
        <div class="log-panel__header">
          <div>
            <h3>로그</h3>
            <span class="log-panel__summary" id="log-summary">최근 요약: -</span>
          </div>
          <button class="log-panel__toggle" id="log-toggle" aria-expanded="false" type="button">
            펼치기
          </button>
        </div>
        <div class="log-panel__entries" id="log"></div>
        <button class="log-panel__scroll-bottom" id="log-scroll-bottom">맨 아래로</button>
      </section>

      <nav class="bottom-dock" id="action-dock" aria-label="하단 도크">
        <button
          class="dock-btn"
          data-sheet="inventory-sheet"
          data-tooltip="장비/인벤토리"
          data-toast="인벤토리"
          aria-label="장비/인벤토리"
          type="button"
        >
          <span class="dock-btn__icon" aria-hidden="true">🎒</span>
          <span class="dock-btn__label">인벤</span>
        </button>
        <button
          class="dock-btn"
          data-sheet="skills-sheet"
          data-tooltip="스킬"
          data-toast="스킬"
          aria-label="스킬"
          type="button"
        >
          <span class="dock-btn__icon" aria-hidden="true">✨</span>
          <span class="dock-btn__label">스킬</span>
        </button>
        <button
          class="dock-btn"
          data-sheet="codex-sheet"
          data-tooltip="도감"
          data-toast="도감"
          aria-label="도감"
          type="button"
        >
          <span class="dock-btn__icon" aria-hidden="true">📖</span>
          <span class="dock-btn__label">도감</span>
        </button>
        <button
          class="dock-btn"
          data-sheet="ranking-sheet"
          data-tooltip="랭킹"
          data-toast="랭킹"
          aria-label="랭킹"
          type="button"
        >
          <span class="dock-btn__icon" aria-hidden="true">🏆</span>
          <span class="dock-btn__label">랭킹</span>
        </button>
        <button
          class="dock-btn"
          data-open="status"
          data-tab="settings"
          data-tooltip="설정/도움말"
          data-toast="설정"
          aria-label="설정/도움말"
          type="button"
        >
          <span class="dock-btn__icon" aria-hidden="true">⚙️</span>
          <span class="dock-btn__label">설정</span>
        </button>
      </nav>
    </div>

    <div class="sheet" id="status-sheet" hidden aria-modal="true" role="dialog">
      <div class="sheet__header">
        <h3>상태 시트</h3>
        <button class="sheet__close" id="btn-close-status" aria-label="닫기">✕</button>
      </div>
      <div class="sheet__tabs" role="tablist">
        <button class="sheet__tab is-active" data-tab="stats" role="tab">스탯</button>
        <button class="sheet__tab" data-tab="progress" role="tab">진행</button>
        <button class="sheet__tab" data-tab="status" role="tab">상태이상</button>
        <button class="sheet__tab" data-tab="inventory" role="tab">인벤/장비</button>
        <button class="sheet__tab" data-tab="settings" role="tab">설정</button>
      </div>
      <div class="sheet__body">
        <section class="sheet__panel is-active" data-panel="stats">
          <div class="stats-grid" id="stats-grid"></div>
        </section>
        <section class="sheet__panel" data-panel="progress">
          <div class="progress-grid">
            <div class="progress-card">
              <span>신뢰</span>
              <strong id="progress-trust">0</strong>
            </div>
            <div class="progress-card">
              <span>단서</span>
              <strong id="progress-insight">0</strong>
            </div>
          </div>
        </section>
        <section class="sheet__panel" data-panel="status">
          <div class="status-list" id="status-list"></div>
        </section>
        <section class="sheet__panel" data-panel="inventory">
          <div class="inventory-grid" id="inventory-grid"></div>
        </section>
        <section class="sheet__panel" data-panel="settings">
          <div class="settings-group">
            <label class="toggle">
              <input type="checkbox" id="toggle-typing" />
              <span>타자기 효과</span>
            </label>
            <label class="toggle">
              <input type="checkbox" id="toggle-autoscroll" checked />
              <span>로그 자동 스크롤</span>
            </label>
          </div>
          <div class="settings-group">
            <label class="select">
              <span>슬롯 선택</span>
              <select id="slot-select">
                <option value="1">Slot 1</option>
                <option value="2">Slot 2</option>
                <option value="3">Slot 3</option>
              </select>
            </label>
            <div class="settings-actions">
              <button id="btn-slot-save" class="btn btn--ghost">슬롯 저장</button>
              <button id="btn-slot-load" class="btn btn--ghost">불러오기</button>
            </div>
            <div class="settings-autosave" id="autosave-status">자동저장: -</div>
          </div>
          <div class="settings-group">
            <strong>긴급 초기화</strong>
            <p>저장 데이터가 꼬였을 때 모든 세이브를 삭제합니다.</p>
            <p>?reset=1로 접속하면 TextRPG 세이브를 초기화할 수 있습니다.</p>
            <button id="btn-emergency-reset" class="btn btn--ghost">긴급 초기화</button>
          </div>
        </section>
      </div>
    </div>

    <div class="sheet" id="inventory-sheet" hidden aria-modal="true" role="dialog">
      <div class="sheet__header">
        <h3>장비/인벤토리</h3>
        <button class="sheet__close" data-close-sheet aria-label="닫기">✕</button>
      </div>
      <div class="sheet__body">
        <div class="sheet__notice" id="inventory-empty">보유 아이템이 없습니다.</div>
        <div class="inventory-grid" id="inventory-sheet-grid"></div>
      </div>
    </div>

    <div class="sheet" id="skills-sheet" hidden aria-modal="true" role="dialog">
      <div class="sheet__header">
        <h3>스킬</h3>
        <button class="sheet__close" data-close-sheet aria-label="닫기">✕</button>
      </div>
      <div class="sheet__body">
        <div class="sheet__notice" id="skills-empty">미구현/예정</div>
        <div class="sheet__list" id="skills-list"></div>
      </div>
    </div>

    <div class="sheet" id="codex-sheet" hidden aria-modal="true" role="dialog">
      <div class="sheet__header">
        <h3>도감</h3>
        <button class="sheet__close" data-close-sheet aria-label="닫기">✕</button>
      </div>
      <div class="sheet__body">
        <div class="codex-section">
          <h4>노드</h4>
          <div class="sheet__notice" id="codex-node-empty">기록 없음</div>
          <ul class="codex-list" id="codex-nodes"></ul>
        </div>
        <div class="codex-section">
          <h4>적</h4>
          <div class="sheet__notice" id="codex-enemy-empty">기록 없음</div>
          <ul class="codex-list" id="codex-enemies"></ul>
        </div>
        <div class="codex-section">
          <h4>엔딩</h4>
          <div class="sheet__notice" id="codex-ending-empty">기록 없음</div>
          <ul class="codex-list" id="codex-endings"></ul>
        </div>
      </div>
    </div>

    <div class="sheet" id="ranking-sheet" hidden aria-modal="true" role="dialog">
      <div class="sheet__header">
        <h3>랭킹</h3>
        <button class="sheet__close" data-close-sheet aria-label="닫기">✕</button>
      </div>
      <div class="sheet__body">
        <div class="sheet__notice" id="ranking-empty">기록 없음</div>
        <div class="sheet__list" id="ranking-list"></div>
      </div>
    </div>

    <div class="sheet" id="action-sheet" hidden aria-modal="true" role="dialog">
      <div class="sheet__header">
        <h3>다른 행동</h3>
        <button class="sheet__close" id="btn-close-actions" aria-label="닫기">✕</button>
      </div>
      <div class="sheet__body">
        <div class="sheet__list" id="action-sheet-list"></div>
      </div>
    </div>

    <div class="sheet" id="item-sheet" hidden aria-modal="true" role="dialog">
      <div class="sheet__header">
        <h3 id="item-sheet-title">아이템</h3>
        <button class="sheet__close" id="btn-close-items" aria-label="닫기">✕</button>
      </div>
      <div class="sheet__body">
        <div class="inventory-grid" id="item-sheet-grid"></div>
      </div>
    </div>

    <div class="backdrop" id="sheet-backdrop" hidden></div>

    <div class="tooltip" id="tooltip" hidden>
      <div class="tooltip__content" id="tooltip-content"></div>
      <div class="tooltip__actions" id="tooltip-actions"></div>
    </div>

    <div class="toast" id="save-toast" role="status" aria-live="polite"></div>

    <script id="appMain" src="main.js?v=0.3.2" defer></script>
  </body>
</html>
